<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sounds â€¢ Enigma</title>

  <link rel="stylesheet" href="/Enigma-/style.css?v=8001">
</head>

<body class="page-wrap">
  <button id="themeFab" class="theme-toggle-top" type="button" aria-label="Toggle night mode">ğŸŒ™</button>

  <header class="page-header">
    <button class="back-btn" type="button" onclick="enigmaBack()" aria-label="Back">â†</button>
    <h1>Sounds</h1>
    <p>Play a gentle background sound</p>
  </header>

  <main class="page">
    <div class="card">
      <div class="section-title">Volume</div>
      <input id="soundVol" type="range" min="0" max="1" step="0.01" value="0.6" />
      <div class="gentle-text">Status: <span id="soundStatus">Not playing</span></div>
      <div class="gentle-text">Tip: Tap a sound once to start (iPhone rule).</div>
    </div>

    <div class="card">
      <div class="section-title">Choose a sound</div>

      <div class="tool-row">
        <button class="tool-btn primary" type="button" data-sound="rain">ğŸŒ§ Rain</button>
        <button class="tool-btn danger" type="button" id="stopBtn">Stop</button>
      </div>

      <div class="tool-row">
        <button class="tool-btn" type="button" data-sound="ocean">ğŸŒŠ Ocean</button>
        <button class="tool-btn" type="button" data-sound="forest">ğŸŒ¿ Forest</button>
      </div>

      <div class="tool-row">
        <button class="tool-btn" type="button" data-sound="fireplace">ğŸ”¥ Fireplace</button>
        <button class="tool-btn" type="button" data-sound="wind">ğŸŒ¬ Wind</button>
      </div>

      <div class="tool-row">
        <button class="tool-btn" type="button" data-sound="white">âšª White noise</button>
        <button class="tool-btn" type="button" data-sound="pink">ğŸŒ¸ Pink noise</button>
      </div>

      <div class="tool-row">
        <button class="tool-btn" type="button" data-sound="chimes">ğŸ”” Chimes</button>
        <button class="tool-btn" type="button" data-sound="meditation">ğŸ§˜ Meditation</button>
      </div>

      <div class="gentle-text" style="margin-top:10px;">
        MP3s optional. If you add MP3s later, put them in <b>/audio/</b> as rain.mp3, ocean.mp3 etc.
      </div>
    </div>
  </main>

  <nav class="bottom-nav">
    <a href="/Enigma-/index.html"><div class="nav-ico">ğŸ </div><span>Home</span></a>
    <a href="/Enigma-/breathe.html"><div class="nav-ico">ğŸŒ¬ï¸</div><span>Breathe</span></a>
    <a href="/Enigma-/journal.html"><div class="nav-ico">ğŸ“–</div><span>Journal</span></a>
    <a href="/Enigma-/quotes.html"><div class="nav-ico">ğŸ’¬</div><span>Quotes</span></a>
    <a href="/Enigma-/game.html"><div class="nav-ico">ğŸ¨</div><span>Colour</span></a>
    <a class="active" href="/Enigma-/sounds.html"><div class="nav-ico">ğŸ§</div><span>Sounds</span></a>
    <a href="/Enigma-/progress.html"><div class="nav-ico">ğŸ“ˆ</div><span>Progress</span></a>
  </nav>

  <!-- your sound engine -->
  <script src="/Enigma-/sounds-engine.js?v=8001"></script>

  <script>
    // fallback back button
    window.enigmaBack = window.enigmaBack || function(){
      if (history.length > 1) history.back();
      else location.href = "/Enigma-/index.html";
    };

    const vol = document.getElementById("soundVol");
    const status = document.getElementById("soundStatus");
    const stopBtn = document.getElementById("stopBtn");

    const savedVol = localStorage.getItem("enigmaSoundVol");
    if (savedVol !== null) vol.value = savedVol;

    EnigmaSounds.onStatus((t)=> status.textContent = t);
    EnigmaSounds.setVolume(parseFloat(vol.value || "0.6"));

    vol.addEventListener("input", () => {
      EnigmaSounds.setVolume(parseFloat(vol.value));
      localStorage.setItem("enigmaSoundVol", vol.value);
    });

    function clearActive(){
      document.querySelectorAll("[data-sound]").forEach(b=> b.classList.remove("active"));
    }

    document.querySelectorAll("[data-sound]").forEach(btn=>{
      btn.addEventListener("click", async () => {
        clearActive();
        btn.classList.add("active");
        await EnigmaSounds.play(btn.dataset.sound);
      }, { passive:true });
    });

    stopBtn.addEventListener("click", () => {
      clearActive();
      EnigmaSounds.stop();
    }, { passive:true });
  </script>
</body>
</html>
